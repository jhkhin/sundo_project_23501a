<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.postgres.sample.service.impl.dao.kjo.WaterResourcesDAO">
	
    <select id="cntWaterResource" resultType="waterResources">
		select count(*) as total
			from water_resources wr, organization org
			where wr.org_code = org.org_code;
    </select>
    
    <select id="findfacility_category" resultType="waterResources">
		select facility_category from water_resources
			group by facility_category
    </select>
    
    <select id="findfacility_addr" resultType="waterResources">
		select facility_addr from water_resources
			group by facility_addr
			order by facility_addr
    </select>
   
    <select id="findWaterResourceLists" resultType="waterResources">
	select  ROW_NUMBER() over() as rn, * from
		(select wr.*, org.org_name, split_part(wr.facility_addr::varchar, ' ', 1) as first_area, split_part(wr.facility_addr::varchar, ' ', 2)as second_area
		from water_resources wr, organization org
		where wr.org_code = org.org_code
		order by facility_code)
    </select>

    <select id="PaingWaterResourceLists" parameterType="waterResources" resultType="waterResources">
	select  ROW_NUMBER() over() as rn, * from
		(select wr.*, org.org_name, split_part(wr.facility_addr::varchar, ' ', 1) as first_area, split_part(wr.facility_addr::varchar, ' ', 2)as second_area
		from water_resources wr, organization org
		where wr.org_code = org.org_code
		order by facility_code)
	offset #{start}-1 limit 10
    </select>
    
    
	
    
</mapper>